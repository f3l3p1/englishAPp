"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const inquirer = require("inquirer");
inquirer.registerPrompt('fileSystemSearch', require('inquirer-fuzzy-path'));
// lists entire filesystem
function queryFileSystem({ context, defaultSearch = '', rootPath = 'src', }) {
    // https://github.com/adelsz/inquirer-fuzzy-path
    return inquirer
        .prompt([
        {
            type: 'fileSystemSearch',
            name: 'path',
            excludePath: (nodePath) => nodePath.startsWith('node_modules'),
            // excludePath :: (String) -> Bool
            // excludePath to exclude some paths from the file-system scan
            itemType: 'any',
            // itemType :: 'any' | 'directory' | 'file'
            // specify the type of nodes to display
            // default value: 'any'
            // example: itemType: 'file' - hides directories from the item list
            rootPath,
            // rootPath :: String
            // Root search directory
            message: 'Select a target directory or spec file:',
            default: defaultSearch,
            suggestOnly: false,
            // suggestOnly :: Bool
            // Restrict prompt answer to available choices or use them as suggestions
            depthLimit: 50,
        },
    ])
        .then(({ path }) => {
        if (!path) {
            context.logger.error('Must select a directory or file');
            throw new Error();
        }
        if (path.endsWith('.spec.ts')) {
            console.log(`file selected ${path}`);
        }
        else {
            console.log(`directory selected ${path}`);
        }
        return {
            path,
            // anything other than a spec file will be considered a directory
            isDir: !path.endsWith('.spec.ts'),
            isSpec: path.endsWith('.spec.ts'),
            // drop the file name to get just the directory: src/app/app.component.spec.ts > src/app
            dir: path
                .split('/')
                .slice(0, -1)
                .join('/'),
        };
    });
}
exports.queryFileSystem = queryFileSystem;
//# sourceMappingURL=file-search.js.map